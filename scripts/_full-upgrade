#!/bin/sh

# Author: Rick Balocca
# Date: 2007
# Description:

XES="/opt/vyatta/bin/xes"

wait_for_reboot()
{
	sleep 20
	reboot
	sleep 99999
}

case "$1" in
-r)	
	# then finish the upgrade in unattended mode
	${XES} /opt/vyatta/bin/install-only &&
        ${XES} /opt/vyatta/bin/remove-packages &&
	wait_for_reboot
	;;
-k)
	# then finish the upgrade in unattended mode
	${XES} /opt/vyatta/bin/install-only &&
	wait_for_reboot
	;;
-i)
	install-only && exec remove-packages
	;;
esac

echo **** Upgrade terminated early
echo **** run dpkg -l to determine
echo **** the state of the packages
echo **** on your system.
exit 1
